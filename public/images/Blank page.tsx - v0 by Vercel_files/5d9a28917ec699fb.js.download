(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,137630,e=>{"use strict";var t,n,s=e.i(266931);function i(e){let t=0,i=0,r=0,a=n.Unknown;for(let o=0,h=e.length;o<h;o++){let d=e.charCodeAt(o);d===s.CharCode.CarriageReturn?(0===t&&(i=o),t++,o+1<h&&e.charCodeAt(o+1)===s.CharCode.LineFeed?(a|=n.CRLF,o++):a|=n.Invalid,r=o+1):d===s.CharCode.LineFeed&&(a|=n.LF,0===t&&(i=o),t++,r=o+1)}return 0===t&&(i=e.length),[t,i,e.length-r,a]}(t=n||(n={}))[t.Unknown=0]="Unknown",t[t.Invalid=3]="Invalid",t[t.LF=1]="LF",t[t.CRLF=2]="CRLF",e.s(["StringEOL",()=>n,"countEOL",()=>i])},967413,e=>{"use strict";var t=e.i(319225),n=e.i(853816);class s{static create(e){return new s(e)}constructor(e){this._tokenInfo=e}forEach(e){let t=0;for(let s of this._tokenInfo)e(new n.OffsetRange(t,t+s.length),s),t+=s.length}slice(e){let t=[],n=0;for(let s of this._tokenInfo){let r=n,a=r+s.length;if(a>e.start){if(r>=e.endExclusive)break;let n=Math.max(0,e.start-r),o=Math.max(0,a-e.endExclusive);t.push(new i(s.length-n-o,s.metadata))}n+=s.length}return s.create(t)}}class i{constructor(e,t){this.length=e,this.metadata=t}}class r{constructor(){this._tokens=[]}add(e,t){this._tokens.push(new i(e,t))}build(){return s.create(this._tokens)}}class a{static createEmpty(e,t){let n=a.defaultTokenMetadata,s=new Uint32Array(2);return s[0]=e.length,s[1]=n,new a(s,e,t)}static createFromTextAndMetadata(e,t){let n=0,s="",i=[];for(let{text:t,metadata:r}of e)i.push(n+t.length,r),n+=t.length,s+=t;return new a(new Uint32Array(i),s,t)}static convertToEndOffset(e,t){let n=(e.length>>>1)-1;for(let t=0;t<n;t++)e[t<<1]=e[t+1<<1];e[n<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let n=0,s=(e.length>>>1)-1;for(;n<s;){let i=n+Math.floor((s-n)/2),r=e[i<<1];if(r===t)return i+1;r<t?n=i+1:r>t&&(s=i)}return n}static{this.defaultTokenMetadata=(t.FontStyle.None<<t.MetadataConsts.FONT_STYLE_OFFSET|t.ColorId.DefaultForeground<<t.MetadataConsts.FOREGROUND_OFFSET|t.ColorId.DefaultBackground<<t.MetadataConsts.BACKGROUND_OFFSET)>>>0}constructor(e,t,n){this._lineTokensBrand=void 0,this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=n}equals(e){return e instanceof a&&this.slicedEquals(e,0,this._tokensCount)}slicedEquals(e,t,n){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;let s=t<<1,i=s+(n<<1);for(let t=s;t<i;t++)if(this._tokens[t]!==e._tokens[t])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){let n=this._tokens[(e<<1)+1],s=t.TokenMetadata.getLanguageId(n);return this.languageIdCodec.decodeLanguageId(s)}getStandardTokenType(e){let n=this._tokens[(e<<1)+1];return t.TokenMetadata.getTokenType(n)}getForeground(e){let n=this._tokens[(e<<1)+1];return t.TokenMetadata.getForeground(n)}getClassName(e){let n=this._tokens[(e<<1)+1];return t.TokenMetadata.getClassNameFromMetadata(n)}getInlineStyle(e,n){let s=this._tokens[(e<<1)+1];return t.TokenMetadata.getInlineStyleFromMetadata(s,n)}getPresentation(e){let n=this._tokens[(e<<1)+1];return t.TokenMetadata.getPresentationFromMetadata(n)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return a.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,n){return new o(this,e,t,n)}withInserted(e){if(0===e.length)return this;let t=0,n=0,s="",i=[],r=0;for(;;){let a=t<this._tokensCount?this._tokens[t<<1]:-1,o=n<e.length?e[n]:null;if(-1!==a&&(null===o||a<=o.offset)){s+=this._text.substring(r,a);let e=this._tokens[(t<<1)+1];i.push(s.length,e),t++,r=a}else if(o){if(o.offset>r){s+=this._text.substring(r,o.offset);let e=this._tokens[(t<<1)+1];i.push(s.length,e),r=o.offset}s+=o.text,i.push(s.length,o.tokenMetadata),n++}else break}return new a(new Uint32Array(i),s,this.languageIdCodec)}getTokensInRange(e){let t=new r,s=this.findTokenIndexAtOffset(e.start),i=this.findTokenIndexAtOffset(e.endExclusive);for(let r=s;r<=i;r++){let s=new n.OffsetRange(this.getStartOffset(r),this.getEndOffset(r)).intersectionLength(e);s>0&&t.add(s,this.getMetadata(r))}return t.build()}getTokenText(e){let t=this.getStartOffset(e),n=this.getEndOffset(e);return this._text.substring(t,n)}forEach(e){let t=this.getCount();for(let n=0;n<t;n++)e(n)}toString(){let e="";return this.forEach(t=>{e+=`[${this.getTokenText(t)}]{${this.getClassName(t)}}`}),e}}class o{constructor(e,t,n,s){this._source=e,this._startOffset=t,this._endOffset=n,this._deltaOffset=s,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let t=this._firstTokenIndex,s=e.getCount();t<s&&!(e.getStartOffset(t)>=n);t++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof o&&this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount)}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){let t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){let t=this._firstTokenIndex+e,n=this._source.getStartOffset(t),s=this._source.getEndOffset(t),i=this._source.getTokenText(t);return n<this._startOffset&&(i=i.substring(this._startOffset-n)),s>this._endOffset&&(i=i.substring(0,i.length-(s-this._endOffset))),i}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}}function h(e,t){let n=t.lineNumber;if(!e.tokenization.isCheapToTokenize(n))return;e.tokenization.forceTokenization(n);let s=e.tokenization.getLineTokens(n),i=s.findTokenIndexAtOffset(t.column-1);return s.getStandardTokenType(i)}e.s(["LineTokens",()=>a,"getStandardTokenTypeAtPosition",()=>h],967413)},72428,e=>{"use strict";class t{constructor(e,t,n){this.owner=e,this.debugNameSource=t,this.referenceFn=n}getDebugName(e){return i(e,this)}}let n=new Map,s=new WeakMap;function i(e,t){let i=s.get(e);if(i)return i;let h=function(e,t){let n,i=s.get(e);if(i)return i;let h=t.owner?function(e){let t,n=a.get(e);if(n)return n;let s=(t=e.constructor)?t.name:"Object",i=r.get(s)??0;i++,r.set(s,i);let o=1===i?s:`${s}#${i}`;return a.set(e,o),o}(t.owner)+".":"",d=t.debugNameSource;if(void 0!==d){if("function"!=typeof d)return h+d;else if(void 0!==(n=d()))return h+n}let u=t.referenceFn;if(void 0!==u&&void 0!==(n=o(u)))return h+n;if(void 0!==t.owner){let n=function(e,t){for(let n in e)if(e[n]===t)return n}(t.owner,e);if(void 0!==n)return h+n}}(e,t);if(h){let t=n.get(h)??0;t++,n.set(h,t);let i=1===t?h:`${h}#${t}`;return s.set(e,i),i}}let r=new Map,a=new WeakMap;function o(e){let t=e.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(t),s=n?n[1]:void 0;return s?.trim()}e.s(["DebugNameData",()=>t,"getDebugName",()=>i,"getFunctionName",()=>o])},797055,e=>{"use strict";let t;function n(){return t}e.s(["getLogger",()=>n])},264111,e=>{"use strict";var t,n,s=e.i(72428),i=e.i(546991);e.i(68858);var r=e.i(394839);e.i(145384);var a=e.i(436120),o=e.i(797055);function h(e){return new c(new s.DebugNameData(void 0,void 0,e),e,void 0,void 0)}function d(e,t){return new c(new s.DebugNameData(e.owner,e.debugName,e.debugReferenceFn??t),t,void 0,void 0)}function u(e,t){return new c(new s.DebugNameData(e.owner,e.debugName,e.debugReferenceFn??t),t,e.createEmptyChangeSummary,e.handleChange)}function l(e,t){let n=new a.DisposableStore,s=u({owner:e.owner,debugName:e.debugName,debugReferenceFn:e.debugReferenceFn??t,createEmptyChangeSummary:e.createEmptyChangeSummary,handleChange:e.handleChange},(e,s)=>{n.clear(),t(e,s,n)});return(0,a.toDisposable)(()=>{s.dispose(),n.dispose()})}function g(e){let t=new a.DisposableStore,n=d({owner:void 0,debugName:void 0,debugReferenceFn:e},n=>{t.clear(),e(n,t)});return(0,a.toDisposable)(()=>{n.dispose(),t.dispose()})}(t=n||(n={}))[t.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",t[t.stale=2]="stale",t[t.upToDate=3]="upToDate";class c{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,s,i){this._debugNameData=e,this._runFn=t,this.createChangeSummary=s,this._handleChange=i,this.state=n.stale,this.updateCount=0,this.disposed=!1,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this._isReaderValid=!1,this.changeSummary=this.createChangeSummary?.(),this._runIfNeeded(),(0,a.trackDisposable)(this)}dispose(){for(let e of(this.disposed=!0,this.dependencies))e.removeObserver(this);this.dependencies.clear(),(0,a.markAsDisposed)(this)}_runIfNeeded(){if(this.state===n.upToDate)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=n.upToDate;let t=this.disposed;try{if(!t){(0,o.getLogger)()?.handleAutorunTriggered(this);let e=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._isReaderValid=!0,this._runFn(this,e)}catch(e){(0,r.onBugIndicatingError)(e)}finally{this._isReaderValid=!1}}}finally{for(let e of this.dependenciesToBeRemoved)e.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===n.upToDate&&(this.state=n.dependenciesMightHaveChanged),this.updateCount++}endUpdate(){try{if(1===this.updateCount)do{if(this.state===n.dependenciesMightHaveChanged){for(let e of(this.state=n.upToDate,this.dependencies))if(e.reportChanges(),this.state===n.stale)break}this._runIfNeeded()}while(this.state!==n.upToDate)}finally{this.updateCount--}(0,i.assertFn)(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===n.upToDate&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=n.dependenciesMightHaveChanged)}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e))try{(!this._handleChange||this._handleChange({changedObservable:e,change:t,didChange:t=>t===e},this.changeSummary))&&(this.state=n.stale)}catch(e){(0,r.onBugIndicatingError)(e)}}readObservable(e){if(!this._isReaderValid)throw new r.BugIndicatingError("The reader object cannot be used outside its compute function!");if(this.disposed)return e.get();e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}}h.Observer=c,e.s(["autorun",()=>h,"autorunHandleChanges",()=>u,"autorunOpts",()=>d,"autorunWithStore",()=>g,"autorunWithStoreHandleChanges",()=>l])},42089,e=>{"use strict";var t=e.i(68858);let n=(e,t)=>e===t;function s(e=n){return(n,s)=>(0,t.equals)(n,s,e)}function i(){return(e,t)=>e.equals(t)}function r(e,t,n){return void 0===n?(t,n)=>null==t||null==n?n===t:e(t,n):null==e||null==t?t===e:n(e,t)}function a(e){return JSON.stringify(function e(t){if(Array.isArray(t))return t.map(e);if(t&&"object"==typeof t)if(Object.getPrototypeOf(t)===Object.prototype){let n=Object.create(null);for(let s of Object.keys(t).sort())n[s]=e(t[s]);return n}else{let e=h.get(t);return void 0===e&&(e=o++,h.set(t,e)),e+"----2b76a038c20c4bcc"}return t}(e))}let o=0,h=new WeakMap;e.s(["equalsIfDefined",()=>r,"getStructuralKey",()=>a,"itemEquals",()=>i,"itemsEquals",()=>s,"strictEquals",()=>n,"structuralEquals",()=>function e(t,n){if(t===n)return!0;if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(!e(t[s],n[s]))return!1;return!0}if(t&&"object"==typeof t&&n&&"object"==typeof n&&Object.getPrototypeOf(t)===Object.prototype&&Object.getPrototypeOf(n)===Object.prototype){let s=Object.keys(t),i=Object.keys(n),r=new Set(i);if(s.length!==i.length)return!1;for(let i of s)if(!r.has(i)||!e(t[i],n[i]))return!1;return!0}return!1}])},755296,e=>{"use strict";let t,n,s,i;var r=e.i(72428),a=e.i(42089);e.i(145384),e.i(436120);var o=e.i(797055);function h(e){t=e}function d(e){n=e}function u(e){s=e}class l{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let n=void 0===t?void 0:e,i=void 0===t?e:t;return s({owner:n,debugName:()=>{let e=(0,r.getFunctionName)(i);if(void 0!==e)return e;let t=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(i.toString());return t?`${this.debugName}.${t[2]}`:n?void 0:`${this.debugName} (mapped)`},debugReferenceFn:i},e=>i(this.read(e),e))}flatten(){return s({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,n){return e.add(t(this,n)),this}keepObserved(e){return e.add(n(this)),this}get debugValue(){return this.get()}}class g extends l{constructor(){super(...arguments),this.observers=new Set}addObserver(e){let t=this.observers.size;this.observers.add(e),0===t&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&0===this.observers.size&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}}function c(e,t){let n=new v(e,t);try{e(n)}finally{n.finish()}}function f(e){if(i)e(i);else{let t=new v(e,void 0);i=t;try{e(t)}finally{t.finish(),i=void 0}}}async function _(e,t){let n=new v(e,t);try{await e(n)}finally{n.finish()}}function b(e,t,n){e?t(e):c(t,n)}class v{constructor(e,t){this._fn=e,this._getDebugName=t,this.updatingObservers=[]}getDebugName(){return this._getDebugName?this._getDebugName():(0,r.getFunctionName)(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this.updatingObservers;for(let t=0;t<e.length;t++){let{observer:n,observable:s}=e[t];n.endUpdate(s)}this.updatingObservers=null}}function p(e,t){return new m("string"==typeof e?new r.DebugNameData(void 0,e,void 0):new r.DebugNameData(e,void 0,void 0),t,a.strictEquals)}class m extends g{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,t,n){super(),this._debugNameData=e,this._equalityComparator=n,this._value=t}get(){return this._value}set(e,t,n){let s;if(!(void 0===n&&this._equalityComparator(this._value,e))){t||(t=s=new v(()=>{},()=>`Setting ${this.debugName}`));try{let s=this._value;for(let i of(this._setValue(e),(0,o.getLogger)()?.handleObservableChanged(this,{oldValue:s,newValue:e,change:n,didChange:!0,hadValue:!0}),this.observers))t.updateObserver(i,this),i.handleChange(this,n)}finally{s&&s.finish()}}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function k(e,t){return new S("string"==typeof e?new r.DebugNameData(void 0,e,void 0):new r.DebugNameData(e,void 0,void 0),t,a.strictEquals)}class S extends m{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){this._value?.dispose()}}e.s(["BaseObservable",()=>g,"ConvenientObservable",()=>l,"ObservableValue",()=>m,"TransactionImpl",()=>v,"_setDerivedOpts",()=>u,"_setKeepObserved",()=>d,"_setRecomputeInitiallyAndOnChange",()=>h,"asyncTransaction",()=>_,"disposableObservableValue",()=>k,"globalTransaction",()=>f,"observableValue",()=>p,"subtransaction",()=>b,"transaction",()=>c])},368994,477958,e=>{"use strict";var t,n,s=e.i(755296),i=e.i(72428),r=e.i(546991),a=e.i(42089),o=e.i(394839),h=e.i(145384),d=e.i(436120),u=e.i(797055);function l(e,t){return void 0!==t?new v(new i.DebugNameData(e,void 0,t),t,void 0,void 0,void 0,a.strictEquals):new v(new i.DebugNameData(void 0,void 0,e),e,void 0,void 0,void 0,a.strictEquals)}function g(e,t,n){return new p(new i.DebugNameData(e,void 0,t),t,void 0,void 0,void 0,a.strictEquals,n)}function c(e,t){return new v(new i.DebugNameData(e.owner,e.debugName,e.debugReferenceFn),t,void 0,void 0,e.onLastObserverRemoved,e.equalsFn??a.strictEquals)}function f(e,t){return new v(new i.DebugNameData(e.owner,e.debugName,void 0),t,e.createEmptyChangeSummary,e.handleChange,void 0,e.equalityComparer??a.strictEquals)}function _(e,t){let n,s;void 0===t?(n=e,s=void 0):(s=e,n=t);let r=new d.DisposableStore;return new v(new i.DebugNameData(s,void 0,n),e=>(r.clear(),n(e,r)),void 0,void 0,()=>r.dispose(),a.strictEquals)}function b(e,t){let n,s,r;return void 0===t?(n=e,s=void 0):(s=e,n=t),new v(new i.DebugNameData(s,void 0,n),e=>{r?r.clear():r=new d.DisposableStore;let t=n(e);return t&&r.add(t),t},void 0,void 0,()=>{r&&(r.dispose(),r=void 0)},a.strictEquals)}(0,s._setDerivedOpts)(c),(t=n||(n={}))[t.initial=0]="initial",t[t.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",t[t.stale=2]="stale",t[t.upToDate=3]="upToDate";class v extends s.BaseObservable{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,s,i,r,a){super(),this._debugNameData=e,this._computeFn=t,this.createChangeSummary=s,this._handleChange=i,this._handleLastObserverRemoved=r,this._equalityComparator=a,this.state=n.initial,this.value=void 0,this.updateCount=0,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=void 0,this._isUpdating=!1,this._isComputing=!1,this._isReaderValid=!1,this.changeSummary=this.createChangeSummary?.()}onLastObserverRemoved(){for(let e of(this.state=n.initial,this.value=void 0,this.dependencies))e.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this._isComputing)throw new o.BugIndicatingError("Cyclic deriveds are not supported yet!");if(0===this.observers.size){let e;try{this._isReaderValid=!0,e=this._computeFn(this,this.createChangeSummary?.())}finally{this._isReaderValid=!1}return this.onLastObserverRemoved(),e}do{if(this.state===n.dependenciesMightHaveChanged){for(let e of this.dependencies)if(e.reportChanges(),this.state===n.stale)break}this.state===n.dependenciesMightHaveChanged&&(this.state=n.upToDate),this._recomputeIfNeeded()}while(this.state!==n.upToDate)return this.value}_recomputeIfNeeded(){if(this.state===n.upToDate)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e;let t=this.state!==n.initial,s=this.value;this.state=n.upToDate;let i=!1;this._isComputing=!1;try{let e=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this._isReaderValid=!0,this.value=this._computeFn(this,e)}finally{for(let e of(this._isReaderValid=!1,this.dependenciesToBeRemoved))e.removeObserver(this);this.dependenciesToBeRemoved.clear()}i=t&&!this._equalityComparator(s,this.value),(0,u.getLogger)()?.handleDerivedRecomputed(this,{oldValue:s,newValue:this.value,change:void 0,didChange:i,hadValue:t})}catch(e){(0,o.onBugIndicatingError)(e)}if(this._isComputing=!1,i)for(let e of this.observers)e.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this._isUpdating)throw new o.BugIndicatingError("Cyclic deriveds are not supported yet!");this.updateCount++,this._isUpdating=!0;try{let e=1===this.updateCount;if(this.state===n.upToDate&&(this.state=n.dependenciesMightHaveChanged,!e))for(let e of this.observers)e.handlePossibleChange(this);if(e)for(let e of this.observers)e.beginUpdate(this)}finally{this._isUpdating=!1}}endUpdate(e){if(this.updateCount--,0===this.updateCount)for(let e of[...this.observers])e.endUpdate(this);(0,r.assertFn)(()=>this.updateCount>=0)}handlePossibleChange(e){if(this.state===n.upToDate&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e))for(let e of(this.state=n.dependenciesMightHaveChanged,this.observers))e.handlePossibleChange(this)}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){let s=!1;try{s=!this._handleChange||this._handleChange({changedObservable:e,change:t,didChange:t=>t===e},this.changeSummary)}catch(e){(0,o.onBugIndicatingError)(e)}let i=this.state===n.upToDate;if(s&&(this.state===n.dependenciesMightHaveChanged||i)&&(this.state=n.stale,i))for(let e of this.observers)e.handlePossibleChange(this)}}readObservable(e){if(!this._isReaderValid)throw new o.BugIndicatingError("The reader object cannot be used outside its compute function!");e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}addObserver(e){let t=!this.observers.has(e)&&this.updateCount>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){let t=this.observers.has(e)&&this.updateCount>0;super.removeObserver(e),t&&e.endUpdate(this)}}class p extends v{constructor(e,t,n,s,i,r,a){super(e,t,n,s,i,r),this.set=a}}e.s(["derived",()=>l,"derivedDisposable",()=>b,"derivedHandleChanges",()=>f,"derivedOpts",()=>c,"derivedWithSetter",()=>g,"derivedWithStore",()=>_],368994);var m=e.i(264111),k=s;function S(e){return new C(e)}class C extends k.ConvenientObservable{constructor(e){super(),this.value=e}get debugName(){return this.toString()}get(){return this.value}addObserver(e){}removeObserver(e){}toString(){return`Const: ${this.value}`}}function T(...e){let t,n,s;return 3===e.length?[t,n,s]=e:[n,s]=e,new N(new i.DebugNameData(t,void 0,s),n,s,()=>N.globalTransaction,a.strictEquals)}function O(e,t,n){return new N(new i.DebugNameData(e.owner,e.debugName,e.debugReferenceFn??n),t,n,()=>N.globalTransaction,e.equalsFn??a.strictEquals)}class N extends k.BaseObservable{constructor(e,t,n,s,i){super(),this._debugNameData=e,this.event=t,this._getValue=n,this._getTransaction=s,this._equalityComparator=i,this.hasValue=!1,this.handleEvent=e=>{let t=this._getValue(e),n=this.value;this.hasValue&&this._equalityComparator(n,t)||(this.value=t,this.hasValue&&(0,k.subtransaction)(this._getTransaction(),e=>{for(let t of this.observers)e.updateObserver(t,this),t.handleChange(this,void 0)},()=>{let e=this.getDebugName();return"Event fired"+(e?`: ${e}`:"")}),this.hasValue=!0)}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}}function E(e,t){return new w(e,t)}T.Observer=N,T.batchEventsGlobally=function(e,t){let n=!1;void 0===N.globalTransaction&&(N.globalTransaction=e,n=!0);try{t()}finally{n&&(N.globalTransaction=void 0)}};class w extends k.BaseObservable{constructor(e,t){super(),this.debugName=e,this.event=t,this.handleEvent=()=>{(0,k.transaction)(e=>{for(let t of this.observers)e.updateObserver(t,this),t.handleChange(this,void 0)},()=>this.debugName)}}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}function L(e){return"string"==typeof e?new y(e):new y(void 0,e)}class y extends k.BaseObservable{get debugName(){return new i.DebugNameData(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}constructor(e,t){super(),this._debugName=e,this._owner=t}trigger(e,t){if(!e)return void(0,k.transaction)(e=>{this.trigger(e,t)},()=>`Trigger signal ${this.debugName}`);for(let n of this.observers)e.updateObserver(n,this),n.handleChange(this,t)}get(){}}function I(e,t){let n,s,i=!1;return T(r=>{let a=(0,m.autorun)(a=>{let o=e.read(a);i?(n&&clearTimeout(n),n=setTimeout(()=>{s=o,r()},t)):(i=!0,s=o)});return{dispose(){a.dispose(),i=!1,s=void 0}}},()=>i?s:e.get())}function D(e){let t=new x(!1,void 0);return e.addObserver(t),(0,d.toDisposable)(()=>{e.removeObserver(t)})}function R(e,t){let n=new x(!0,t);return e.addObserver(n),t?t(e.get()):e.reportChanges(),(0,d.toDisposable)(()=>{e.removeObserver(n)})}(0,k._setKeepObserved)(D),(0,k._setRecomputeInitiallyAndOnChange)(R);class x{constructor(e,t){this._forceRecompute=e,this._handleValue=t,this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter--,0===this._counter&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}}function F(e,t){let n;return c({owner:e,debugReferenceFn:t},e=>n=t(e,n))}function z(e,t){let n,s=L("derivedObservableWithWritableCache");return Object.assign(l(e,e=>(s.read(e),n=t(e,n))),{clearCache:e=>{n=void 0,s.trigger(e)},setCache:(e,t)=>{n=e,s.trigger(t)}})}function M(e,t,n,s){let i=new A(n,s);return c({debugReferenceFn:n,owner:e,onLastObserverRemoved:()=>{i.dispose(),i=new A(n)}},e=>(i.setItems(t.read(e)),i.getItems()))}class A{constructor(e,t){this._map=e,this._keySelector=t,this._cache=new Map,this._items=[]}dispose(){this._cache.forEach(e=>e.store.dispose()),this._cache.clear()}setItems(e){let t=[],n=new Set(this._cache.keys());for(let s of e){let e=this._keySelector?this._keySelector(s):s,i=this._cache.get(e);if(i)n.delete(e);else{let t=new d.DisposableStore;i={out:this._map(s,t),store:t},this._cache.set(e,i)}t.push(i.out)}for(let e of n)this._cache.get(e).store.dispose(),this._cache.delete(e);this._items=t}getItems(){return this._items}}class B{constructor(e){this.observable=e}get onDidChange(){return h.Event.fromObservableLight(this.observable)}get value(){return this.observable.get()}}function U(e,t){return t instanceof B?t.observable:T(e,t.onDidChange,()=>t.value)}function V(e,t){return F(e,(e,n)=>n??t(e))}function W(e,t){let n;return(0,m.autorunWithStoreHandleChanges)({createEmptyChangeSummary:()=>({deltas:[],didChange:!1}),handleChange:(t,n)=>{if(t.didChange(e)){let e=t.change;void 0!==e&&n.deltas.push(e),n.didChange=!0}return!0}},(s,i)=>{let r=e.read(s),a=n;i.didChange&&(n=r,t(r,a,i.deltas))})}function q(e,t){let n=new d.DisposableStore,s=W(e,(e,s,i)=>{n.clear(),t(e,s,i,n)});return{dispose(){s.dispose(),n.dispose()}}}e.s(["ValueWithChangeEventFromObservable",()=>B,"constObservable",()=>S,"debouncedObservable2",()=>I,"derivedConstOnceDefined",()=>V,"derivedObservableWithCache",()=>F,"derivedObservableWithWritableCache",()=>z,"keepObserved",()=>D,"mapObservableArrayCached",()=>M,"observableFromEvent",()=>T,"observableFromEventOpts",()=>O,"observableFromValueWithChangeEvent",()=>U,"observableSignal",()=>L,"observableSignalFromEvent",()=>E,"recomputeInitiallyAndOnChange",()=>R,"runOnChange",()=>W,"runOnChangeWithStore",()=>q],477958)},226191,131986,e=>{"use strict";var t=e.i(418964),n=e.i(319225);let s=new class{clone(){return this}equals(e){return this===e}};function i(e,n){return new t.TokenizationResult([new t.Token(0,"",e)],n)}function r(e,i){let r=new Uint32Array(2);return r[0]=0,r[1]=(e<<n.MetadataConsts.LANGUAGEID_OFFSET|n.StandardTokenType.Other<<n.MetadataConsts.TOKEN_TYPE_OFFSET|n.FontStyle.None<<n.MetadataConsts.FONT_STYLE_OFFSET|n.ColorId.DefaultForeground<<n.MetadataConsts.FOREGROUND_OFFSET|n.ColorId.DefaultBackground<<n.MetadataConsts.BACKGROUND_OFFSET)>>>0,new t.EncodedTokenizationResult(r,null===i?s:i)}e.s(["NullState",()=>s,"nullTokenize",()=>i,"nullTokenizeEncoded",()=>r],226191);var a=e.i(68858);class o{constructor(e){this._default=e,this._store=[]}get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,n){if(e>=this._store.length)return;if(0===t)return void this.insert(e,n);if(0===n)return void this.delete(e,t);let s=this._store.slice(0,e),i=this._store.slice(e+t),r=function(e,t){let n=[];for(let s=0;s<e;s++)n[s]=t;return n}(n,this._default);this._store=s.concat(r,i)}delete(e,t){0===t||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(0===t||e>=this._store.length)return;let n=[];for(let e=0;e<t;e++)n[e]=this._default;this._store=(0,a.arrayInsert)(this._store,e,n)}}e.s(["FixedArray",()=>o],131986)},496160,183987,380193,e=>{"use strict";var t,n,s=e.i(395806),i=e.i(394839),r=e.i(509592),a=e.i(225696),o=e.i(137630),h=e.i(232837),d=e.i(853816),u=e.i(319225),l=e.i(226191),g=e.i(131986),c=e.i(182408),f=e.i(68858),_=e.i(747053),b=e.i(967413);let v=new Uint32Array(0).buffer;class p{static deleteBeginning(e,t){return null===e||e===v?e:p.delete(e,0,t)}static deleteEnding(e,t){if(null===e||e===v)return e;let n=m(e),s=n[n.length-2];return p.delete(e,t,s)}static delete(e,t,n){let s,i;if(null===e||e===v||t===n)return e;let r=m(e),a=r.length>>>1;if(0===t&&r[r.length-2]===n)return v;let o=b.LineTokens.findIndexInTokensArray(r,t),h=o>0?r[o-1<<1]:0;if(n<r[o<<1]){let s=n-t;for(let e=o;e<a;e++)r[e<<1]-=s;return e}h!==t?(r[o<<1]=t,s=o+1<<1,i=t):(s=o<<1,i=h);let d=n-t;for(let e=o+1;e<a;e++){let t=r[e<<1]-d;t>i&&(r[s++]=t,r[s++]=r[(e<<1)+1],i=t)}if(s===r.length)return e;let u=new Uint32Array(s);return u.set(r.subarray(0,s),0),u.buffer}static append(e,t){if(t===v)return e;if(e===v)return t;if(null===e)return e;if(null===t)return null;let n=m(e),s=m(t),i=s.length>>>1,r=new Uint32Array(n.length+s.length);r.set(n,0);let a=n.length,o=n[n.length-2];for(let e=0;e<i;e++)r[a++]=s[e<<1]+o,r[a++]=s[(e<<1)+1];return r.buffer}static insert(e,t,n){if(null===e||e===v)return e;let s=m(e),i=s.length>>>1,r=b.LineTokens.findIndexInTokensArray(s,t);r>0&&s[r-1<<1]===t&&r--;for(let e=r;e<i;e++)s[e<<1]+=n;return e}}function m(e){return e instanceof Uint32Array?e:new Uint32Array(e)}e.s(["ContiguousTokensEditing",()=>p,"EMPTY_LINE_TOKENS",()=>v,"toUint32Array",()=>m],183987);class k{static deserialize(e,t,n){let s=new Uint32Array(e.buffer),i=(0,c.readUInt32BE)(e,t);t+=4;let r=(0,c.readUInt32BE)(e,t);t+=4;let a=[];for(let n=0;n<r;n++){let n=(0,c.readUInt32BE)(e,t);t+=4,a.push(s.subarray(t/4,t/4+n/4)),t+=n}return n.push(new k(i,a)),t}get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineRange(){return new h.LineRange(this._startLineNumber,this._startLineNumber+this._tokens.length)}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}serializeSize(){let e;e=8;for(let t=0;t<this._tokens.length;t++){let n=this._tokens[t];if(!(n instanceof Uint32Array))throw Error("Not supported!");e+=4,e+=n.byteLength}return e}serialize(e,t){(0,c.writeUInt32BE)(e,this._startLineNumber,t),t+=4,(0,c.writeUInt32BE)(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++){let s=this._tokens[n];if(!(s instanceof Uint32Array))throw Error("Not supported!");(0,c.writeUInt32BE)(e,s.byteLength,t),t+=4,e.set(new Uint8Array(s.buffer),t),t+=s.byteLength}return t}applyEdit(e,t){let[n,s]=(0,o.countEOL)(t);this._acceptDeleteRange(e),this._acceptInsertText(new _.Position(e.startLineNumber,e.startColumn),n,s)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;let t=e.startLineNumber-this._startLineNumber,n=e.endLineNumber-this._startLineNumber;if(n<0){let e=n-t;this._startLineNumber-=e;return}if(!(t>=this._tokens.length)){if(t<0&&n>=this._tokens.length){this._startLineNumber=0,this._tokens=[];return}if(t===n){this._tokens[t]=p.delete(this._tokens[t],e.startColumn-1,e.endColumn-1);return}if(t>=0)if(this._tokens[t]=p.deleteEnding(this._tokens[t],e.startColumn-1),n<this._tokens.length){let s=p.deleteBeginning(this._tokens[n],e.endColumn-1);this._tokens[t]=p.append(this._tokens[t],s),this._tokens.splice(t+1,n-t)}else this._tokens[t]=p.append(this._tokens[t],null),this._tokens=this._tokens.slice(0,t+1);else this._startLineNumber-=-t,this._tokens[n]=p.deleteBeginning(this._tokens[n],e.endColumn-1),this._tokens=this._tokens.slice(n)}}_acceptInsertText(e,t,n){if(0===t&&0===n)return;let s=e.lineNumber-this._startLineNumber;if(s<0){this._startLineNumber+=t;return}if(!(s>=this._tokens.length)){if(0===t){this._tokens[s]=p.insert(this._tokens[s],e.column-1,n);return}this._tokens[s]=p.deleteEnding(this._tokens[s],e.column-1),this._tokens[s]=p.insert(this._tokens[s],e.column-1,n),this._insertLines(e.lineNumber,t)}}_insertLines(e,t){if(0===t)return;let n=[];for(let e=0;e<t;e++)n[e]=null;this._tokens=(0,f.arrayInsert)(this._tokens,e,n)}}class S{static deserialize(e){let t=0,n=(0,c.readUInt32BE)(e,t);t+=4;let s=[];for(let i=0;i<n;i++)t=k.deserialize(e,t,s);return s}constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){let n=this._tokens[this._tokens.length-1];if(n.endLineNumber+1===e)return void n.appendLineTokens(t)}this._tokens.push(new k(e,[t]))}finalize(){return this._tokens}serialize(){let e=new Uint8Array(this._serializeSize());return this._serialize(e),e}_serializeSize(){let e;e=4;for(let t=0;t<this._tokens.length;t++)e+=this._tokens[t].serializeSize();return e}_serialize(e){let t=0;(0,c.writeUInt32BE)(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++)t=this._tokens[n].serialize(e,t)}}e.s(["ContiguousMultilineTokensBuilder",()=>S],380193),(t=n||(n={}))[t.CHEAP_TOKENIZATION_LENGTH_LIMIT=2048]="CHEAP_TOKENIZATION_LENGTH_LIMIT";class C{constructor(e,t){this.tokenizationSupport=t,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new O(e)}getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}}class T extends C{constructor(e,t,n,s){super(e,t),this._textModel=n,this._languageIdCodec=s}updateTokensUntilLine(e,t){let n=this._textModel.getLanguageId();for(;;){let s=this.getFirstInvalidLine();if(!s||s.lineNumber>t)break;let i=this._textModel.getLineContent(s.lineNumber),r=w(this._languageIdCodec,n,this.tokenizationSupport,i,!0,s.startState);e.add(s.lineNumber,r.tokens),this.store.setEndState(s.lineNumber,r.endState)}}getTokenTypeIfInsertingCharacter(e,t){let n=this.getStartState(e.lineNumber);if(!n)return u.StandardTokenType.Other;let s=this._textModel.getLanguageId(),i=this._textModel.getLineContent(e.lineNumber),r=i.substring(0,e.column-1)+t+i.substring(e.column-1),a=w(this._languageIdCodec,s,this.tokenizationSupport,r,!0,n),o=new b.LineTokens(a.tokens,r,this._languageIdCodec);if(0===o.getCount())return u.StandardTokenType.Other;let h=o.findTokenIndexAtOffset(e.column-1);return o.getStandardTokenType(h)}tokenizeLineWithEdit(e,t){let n=this.getStartState(e);if(!n)return{mainLineTokens:null,additionalLines:null};let s=this._textModel.getLineContent(e),i=t.lineEdit.apply(s),r=this._textModel.getLanguageIdAtPosition(e,0),a=w(this._languageIdCodec,r,this.tokenizationSupport,i,!0,n),o=null;if(t.additionalLines){o=[];let e=a.endState;for(let n of t.additionalLines){let t=w(this._languageIdCodec,r,this.tokenizationSupport,n,!0,e);o.push(new b.LineTokens(t.tokens,n,this._languageIdCodec)),e=t.endState}}return{mainLineTokens:new b.LineTokens(a.tokens,i,this._languageIdCodec),additionalLines:o}}hasAccurateTokensForLine(e){return e<this.store.getFirstInvalidEndStateLineNumberOrMax()}isCheapToTokenize(e){let t=this.store.getFirstInvalidEndStateLineNumberOrMax();return!!(e<t||e===t&&this._textModel.getLineLength(e)<n.CHEAP_TOKENIZATION_LENGTH_LIMIT)}tokenizeHeuristically(e,t,n){if(n<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(t<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(e,n),{heuristicTokens:!1};let s=this.guessStartState(t),i=this._textModel.getLanguageId();for(let r=t;r<=n;r++){let t=this._textModel.getLineContent(r),n=w(this._languageIdCodec,i,this.tokenizationSupport,t,!0,s);e.add(r,n.tokens),s=n.endState}return{heuristicTokens:!0}}guessStartState(e){let t=this._textModel.getLineFirstNonWhitespaceColumn(e),n=[],s=null;for(let i=e-1;t>1&&i>=1;i--){let e=this._textModel.getLineFirstNonWhitespaceColumn(i);if(0!==e&&e<t&&(n.push(this._textModel.getLineContent(i)),t=e,s=this.getStartState(i)))break}s||(s=this.tokenizationSupport.getInitialState()),n.reverse();let i=this._textModel.getLanguageId(),r=s;for(let e of n)r=w(this._languageIdCodec,i,this.tokenizationSupport,e,!1,r).endState;return r}}class O{constructor(e){this.lineCount=e,this._tokenizationStateStore=new N,this._invalidEndStatesLineNumbers=new E,this._invalidEndStatesLineNumbers.addRange(new d.OffsetRange(1,e+1))}getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new i.BugIndicatingError("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);let n=this._tokenizationStateStore.setEndState(e,t);return n&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new d.OffsetRange(e+1,e+2)),n}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new d.OffsetRange(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(let t of e){let[e]=(0,o.countEOL)(t.text);this.acceptChange(new h.LineRange(t.range.startLineNumber,t.range.endLineNumber+1),e+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new d.OffsetRange(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return null===this._invalidEndStatesLineNumbers.min}getStartState(e,t){return 1===e?t:this.getEndState(e-1)}getFirstInvalidLine(e){let t=this.getFirstInvalidEndStateLineNumber();if(null===t)return null;let n=this.getStartState(t,e);if(!n)throw new i.BugIndicatingError("Start state must be defined");return{lineNumber:t,startState:n}}}class N{constructor(){this._lineEndStates=new g.FixedArray(null)}getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){let n=this._lineEndStates.get(e);return!(n&&n.equals(t))&&(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let n=e.length;t>0&&n>0&&(n--,t--),this._lineEndStates.replace(e.startLineNumber,n,t)}acceptChanges(e){for(let t of e){let[e]=(0,o.countEOL)(t.text);this.acceptChange(new h.LineRange(t.range.startLineNumber,t.range.endLineNumber+1),e+1)}}}class E{constructor(){this._ranges=[]}getRanges(){return this._ranges}get min(){return 0===this._ranges.length?null:this._ranges[0].start}removeMin(){if(0===this._ranges.length)return null;let e=this._ranges[0];return e.start+1===e.endExclusive?this._ranges.shift():this._ranges[0]=new d.OffsetRange(e.start+1,e.endExclusive),e.start}delete(e){let t=this._ranges.findIndex(t=>t.contains(e));if(-1!==t){let n=this._ranges[t];n.start===e?n.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new d.OffsetRange(e+1,n.endExclusive):n.endExclusive===e+1?this._ranges[t]=new d.OffsetRange(n.start,e):this._ranges.splice(t,1,new d.OffsetRange(n.start,e),new d.OffsetRange(e+1,n.endExclusive))}}addRange(e){d.OffsetRange.addRange(e,this._ranges)}addRangeAndResize(e,t){let n=0;for(;!(n>=this._ranges.length||e.start<=this._ranges[n].endExclusive);)n++;let s=n;for(;!(s>=this._ranges.length||e.endExclusive<this._ranges[s].start);)s++;let i=t-e.length;for(let e=s;e<this._ranges.length;e++)this._ranges[e]=this._ranges[e].delta(i);if(n===s){let s=new d.OffsetRange(e.start,e.start+t);s.isEmpty||this._ranges.splice(n,0,s)}else{let t=Math.min(e.start,this._ranges[n].start),r=Math.max(e.endExclusive,this._ranges[s-1].endExclusive),a=new d.OffsetRange(t,r+i);a.isEmpty?this._ranges.splice(n,s-n):this._ranges.splice(n,s-n,a)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}}function w(e,t,n,s,r,a){let o=null;if(n)try{o=n.tokenizeEncoded(s,r,a.clone())}catch(e){(0,i.onUnexpectedError)(e)}return o||(o=(0,l.nullTokenizeEncoded)(e.encodeLanguageId(t),a)),b.LineTokens.convertToEndOffset(o.tokens,s.length),o}class L{constructor(e,t){this._tokenizerWithStateStore=e,this._backgroundTokenStore=t,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){!this._isScheduled&&this._tokenizerWithStateStore._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._isScheduled=!0,(0,s.runWhenGlobalIdle)(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){let t=Date.now()+e.timeRemaining(),n=()=>{!this._isDisposed&&this._tokenizerWithStateStore._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?(0,r.setTimeout0)(n):this._beginBackgroundTokenization())};n()}_backgroundTokenizeForAtLeast1ms(){let e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new S,n=a.StopWatch.create(!1);do if(n.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize())this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return!!this._tokenizerWithStateStore&&!this._tokenizerWithStateStore.store.allStatesValid()}_tokenizeOneInvalidLine(e){let t=this._tokenizerWithStateStore?.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){!this._isDisposed&&this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new h.LineRange(e,t))}}e.s(["DefaultBackgroundTokenizer",()=>L,"TokenizationStateStore",()=>N,"TokenizerWithStateStore",()=>C,"TokenizerWithStateStoreAndTextModel",()=>T,"TrackingTokenizationStateStore",()=>O],496160)}]);